import{i as p,g as _,s as E}from"./utils.d6b00222.js";const y=["data-src"],g=Vue.createElementVNode("div",{class:"x-image__placeholder"},"Loading...",-1),h=Vue.createElementVNode("div",{class:"x-image__error"},"Failed",-1),F=["src"],B=Vue.defineComponent({props:{src:null,fit:{default:"cover"},aspect:null,lazy:{type:Boolean},scrollContainer:null},setup(l){const t=l,s=Vue.ref(!0),a=Vue.ref(!1),n=Vue.ref(),r=Vue.ref(),v=Vue.computed(()=>({objectFit:t.fit})),i=Vue.computed(()=>{var e;return(e=t.aspect)==null?void 0:e.split("/").every(u=>!Number.isNaN(Number(u)))}),V=Vue.computed(()=>{if(!i.value)return{};const e=t.aspect.split("/");return{"--aspect-w":e[0],"--aspect-h":e[1]}}),o=()=>{const e=new Image,u=t.src;e.src=u,e.addEventListener("load",f=>{u==t.src&&(s.value=!1,a.value=!1)}),e.addEventListener("error",f=>{u==t.src&&(s.value=!1,a.value=!0)})},d=()=>{var e;(e=r.value)==null||e.removeEventListener("scroll",c),r.value=void 0},c=()=>{p(n.value,r.value)&&(o(),d())},m=()=>{var u;const{scrollContainer:e}=t;e instanceof Element?r.value=e:typeof e=="string"&&e!=""?r.value=(u=document.querySelector(e))!=null?u:void 0:n.value&&(r.value=_(n.value)),r.value&&(r.value.addEventListener("scroll",c),c())};return Vue.watch(()=>t.src,()=>{s.value=!0,a.value=!1,t.lazy?(d(),m()):o()}),Vue.onMounted(()=>{t.lazy?m():o()}),(e,u)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:Vue.normalizeClass(["x-image",{"x-image--aspect":Vue.unref(i)}]),"data-src":l.src,style:Vue.normalizeStyle(Vue.unref(V)),ref_key:"container",ref:n},[s.value?Vue.renderSlot(e.$slots,"placeholder",{key:0},()=>[g]):a.value?Vue.renderSlot(e.$slots,"error",{key:1},()=>[h]):(Vue.openBlock(),Vue.createElementBlock("img",Vue.mergeProps({key:2,class:"x-image__inner"},e.$attrs,{src:l.src,style:Vue.unref(v)}),null,16,F))],14,y))}}),C=Vue.createElementVNode("div",{class:"text-center py-5 text-2xl"},"\u6EDA\u52A8\u9875\u9762\u67E5\u770B\u56FE\u7247\u52A0\u8F7D",-1),L=Vue.createElementVNode("div",{class:"h-[150vh]"},null,-1),A=Vue.createElementVNode("div",{class:"h-screen"},null,-1),k=Vue.defineComponent({setup(l){return E("\u81EA\u5B9A\u4E49\u56FE\u7247\u7EC4\u4EF6\uFF0C\u663E\u793A\u52A0\u8F7D\u72B6\u6001\u548C error \u72B6\u6001\uFF0C\u652F\u6301\u56FA\u5B9A\u5BBD\u9AD8\u6BD4\uFF0C\u652F\u6301\u61D2\u52A0\u8F7D"),(t,s)=>(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[C,L,Vue.createVNode(B,{class:"w-52 mx-auto",src:"http://qiniu.pxcoder.club/others/20220224091542BSOSTrbnVd",lazy:"",aspect:"4/3"},null,8,["src"]),A],64))}});export{k as default};
